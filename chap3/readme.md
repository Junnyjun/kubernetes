#### 컨테이너를 다루는 쿠버네티스

> 컨테이너 인프라 환경

리눅스 운영체제의 커널 하나에서 여러개의 컨테이너가 격리된 상태로 실행되는 인프라 환경



#### 쿠버네티스

컨테이너 오케스트레이션을 위한 솔루션.

###### :question: 오케스트레이션 -> 복잡한 단계를 관리하고 요소들의 유기적인 관계를 미리 정의해 손쉽게 사용하도록 서비스를 제공



> 구성방법

1. 클라우드 업체를 사용 - EKS, AKS, GKE
2. Rancher , OpenShift 등 설치형 쿠버네티스 사용
3. 쿠버네티스 클러스터를 자동으로 구성해주는 솔루션 사용




##### 쿠버네티스 구성하기


> [Vagrantfile](./Vagrantfile_1) 

> [config.sh](./config.sh)

> [install.pkg](./install_pkg.sh)

> [masternode](./master_node.sh)

> [work_nodes](work_nodes.sh)



##### 쿠버네티스의 구성 요소간 통신



> ###### 마스터 노트 

1. Kubectl - 쿠버네티스 클러스터에 명령을 내리는 역할을 한다.

바로 실행되는 명령 형태인 바이너리로 배포되기 때문에 마스터 노드에 있을 필요는 없다

2. API server - 클러스터의 중심 역할을 하는 통로, 주로 상태값을 저장하는 etcd랑 통신하지만, 

그 밖의 요소들 또한 API 서버를 중심에 두고 통신하므로 API서버의 역할이 중요

3. ETCD - 구성요소들의 상태값이 모두 저장되는 장소

etcd외의 다른 구성 요소는 상태 값을 관리하지 않는다. etcd의 정보만 백업되어 있다면 긴급한 장애 상황에서도 쿠버네티스 클러스터를 복구 할 수있다.

4. Controller Manager - 쿠버네티스 클러스터의 오브젝트 상태를 관리
5. Scheduler - 노드의 상태와 자원, 레이블, 요구조건등을 고려해 파드를 어떤 워커 노드에 생성 할 것인지를 결정하고 할당합니다

> ###### 워커 노드

1. Kubelet - 파드의 구성 내용을 받아서 컨테이너 런타임으로 전달하고 파드안의 컨테이너들이 정상적으로 작동하는지 모니터링한다.
2. CRI - 파드를 이루를 컨테이너의 실행을 담당한다. 파드 안에서 다양한 종류의 컨테이너가 문제없이 작동하게 만드는 표준 인터페이스.
3. POD - 한개 이상의 컨테이너로 단일 목적의 일을 하기위해서 모인 단위. ( 언제라도 죽을 수 있는 존재)
4. network plugin - 일반적으로 CNI로 구성한다.
5. CoreDNS - 클라우드 네이티브 컴퓨팅 재단에서 보증하는 프로젝트



###### :hear_no_evil:IF ) 사용자가 배포된 파드에 접속할 때

1. kube-proxy - 쿠버네티스 클러스터는 파드가 위치한 노드에 kube-proxy를 통해 파드가 통신할 수 있는 네트워크를 설정.
2. pod - 이미 배포된 파드에 접속하고 필요한 내용을 전달받는다.

